{
  "proxy_key": "proxy-{{.service.serviceName}}",
  "zone_key": "{{.service.zone}}",
  "name": "{{.service.serviceName}}",
  "domain_keys": [
    "domain-{{.service.serviceName}}"
  ],
  "listener_keys": [
      "listener-{{.service.serviceName}}"
  ],
  "listeners": null,
  "active_proxy_filters": ["gm.metrics"],
  "proxy_filters": {
    "gm_metrics": {
      "metrics_port": 8081,
      "metrics_host": "0.0.0.0",
      "metrics_dashboard_uri_path": "/metrics",
      "metrics_prometheus_uri_path": "/prometheus",
      "prometheus_system_metrics_interval_seconds": 15,
      "metrics_ring_buffer_size": 4096,
      "metrics_key_function": "depth",
      "metrics_key_depth": "1"
    }
  }{{- if .service.mTLS }}{{ if .Values.global.spire.enabled }},
  "secret": {
    "secret_key": "secret-{{.service.serviceName}}-secret",
    "secret_name": "spiffe://deciphernow.com/{{.service.serviceName}}/mTLS",
    "secret_validation_name": "spiffe://deciphernow.com",
    "ecdh_curves": [
        "X25519:P-256:P-521:P-384"
    ],
    "forward_client_cert_details": "SANITIZE_SET",
    "set_current_client_cert_details": {
        "uri": true
    }
  }
  {{- end }}
  {{- end }}
}